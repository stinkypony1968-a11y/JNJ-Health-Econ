<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Florida / Georgia â€” Territory Map | J&J MedTech Neurovascular</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
/* â”€â”€ Reset & Variables â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
:root {
  --jnj-navy: #00205B;
  --jnj-red: #EB1700;
  --jnj-blue: #0077C8;
  --jnj-dark: #001A47;
  --sidebar-width: 380px;
  --drawer-width: 460px;
  --analytics-height: 64px;
  --header-height: 56px;
  --cert-csc: #EB1700;
  --cert-psc: #F59E0B;
  --cert-tsc: #0077C8;
  --cert-none: #6B7280;
  --tier-1: #059669;
  --tier-2: #F59E0B;
  --tier-3: #6B7280;
  --dept-physician: #0077C8;
  --dept-stroke: #EB1700;
  --dept-education: #7C3AED;
  --dept-buying: #059669;
}
html, body { height: 100%; font-family: 'Inter', -apple-system, sans-serif; background: #f0f2f5; color: #1a1a2e; }
body { display: flex; flex-direction: column; overflow: hidden; }

/* â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.header {
  height: var(--header-height); background: var(--jnj-navy);
  display: flex; align-items: center; padding: 0 20px; gap: 16px; z-index: 1000;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}
.header-logo {
  font-size: 13px; font-weight: 700; color: white; letter-spacing: 0.5px;
  display: flex; align-items: center; gap: 8px;
}
.header-logo .jnj-mark {
  width: 28px; height: 28px; background: var(--jnj-red); border-radius: 4px;
  display: flex; align-items: center; justify-content: center;
  font-size: 11px; font-weight: 800; color: white; letter-spacing: 0;
}
.header-territory { font-size: 16px; font-weight: 600; color: white; flex: 1; }
.header-rep { font-size: 12px; color: rgba(255,255,255,0.7); }
.header-rep strong { color: white; font-weight: 600; }
.header-actions { display: flex; gap: 8px; }
.header-btn {
  background: rgba(255,255,255,0.12); border: 1px solid rgba(255,255,255,0.2);
  color: white; padding: 6px 14px; border-radius: 6px; font-size: 12px;
  font-weight: 500; cursor: pointer; transition: all 0.15s; font-family: inherit;
}
.header-btn:hover { background: rgba(255,255,255,0.2); }
.header-btn.active { background: var(--jnj-blue); border-color: var(--jnj-blue); }

/* â”€â”€ Main Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.main-container { flex: 1; display: flex; position: relative; overflow: hidden; }

/* â”€â”€ Left Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.sidebar {
  width: var(--sidebar-width); background: white; display: flex;
  flex-direction: column; border-right: 1px solid #e2e8f0; z-index: 500;
}
.sidebar-header { padding: 12px 16px; border-bottom: 1px solid #e2e8f0; }
.sidebar-search {
  width: 100%; padding: 8px 12px; border: 1px solid #e2e8f0; border-radius: 6px;
  font-size: 13px; font-family: inherit; outline: none; transition: border 0.15s;
}
.sidebar-search:focus { border-color: var(--jnj-blue); }
.sidebar-filters {
  display: flex; gap: 4px; padding: 8px 16px; border-bottom: 1px solid #e2e8f0; flex-wrap: wrap;
}
.filter-btn {
  padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 500;
  cursor: pointer; border: 1px solid #e2e8f0; background: white; color: #64748b;
  transition: all 0.15s; font-family: inherit;
}
.filter-btn:hover { background: #f8fafc; }
.filter-btn.active { background: var(--jnj-navy); color: white; border-color: var(--jnj-navy); }
.sidebar-sort {
  display: flex; align-items: center; gap: 6px; padding: 6px 16px;
  border-bottom: 1px solid #e2e8f0; font-size: 11px; color: #94a3b8;
}
.sort-select {
  border: none; font-size: 11px; color: var(--jnj-navy); font-weight: 500;
  cursor: pointer; font-family: inherit; outline: none; background: transparent;
}
.sidebar-list { flex: 1; overflow-y: auto; padding: 8px; }
.sidebar-list::-webkit-scrollbar { width: 5px; }
.sidebar-list::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }

/* â”€â”€ Hospital Cards â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.hospital-card {
  padding: 12px; border-radius: 8px; border: 1px solid #e2e8f0; margin-bottom: 6px;
  cursor: pointer; transition: all 0.15s; position: relative;
}
.hospital-card:hover { border-color: var(--jnj-blue); box-shadow: 0 2px 8px rgba(0,119,200,0.1); }
.hospital-card.selected { border-color: var(--jnj-blue); background: #f0f7ff; }
.card-header { display: flex; align-items: flex-start; gap: 8px; margin-bottom: 6px; }
.card-rank {
  width: 22px; height: 22px; border-radius: 50%; background: var(--jnj-navy);
  color: white; font-size: 10px; font-weight: 700; display: flex;
  align-items: center; justify-content: center; flex-shrink: 0; margin-top: 1px;
}
.card-name { font-size: 13px; font-weight: 600; color: var(--jnj-navy); flex: 1; line-height: 1.3; }
.card-badges { display: flex; gap: 4px; flex-shrink: 0; }
.badge {
  padding: 2px 7px; border-radius: 4px; font-size: 10px; font-weight: 600;
  letter-spacing: 0.3px; white-space: nowrap;
}
.badge-cert { color: white; }
.badge-tier { color: white; }
.card-meta { display: flex; flex-wrap: wrap; gap: 8px; font-size: 11px; color: #64748b; margin-bottom: 6px; padding-left: 30px; }
.card-meta span { display: flex; align-items: center; gap: 3px; }
.card-stats { display: flex; gap: 12px; padding-left: 30px; align-items: center; }
.card-stat-item { font-size: 11px; }
.card-stat-label { color: #94a3b8; }
.card-stat-value { font-weight: 600; color: var(--jnj-navy); }
.card-infra-score {
  margin-left: auto; font-size: 13px; font-weight: 700; padding: 2px 8px;
  border-radius: 4px; background: #f1f5f9;
}

/* â”€â”€ Map Container â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.map-container { flex: 1; position: relative; }
#map { width: 100%; height: 100%; }
.leaflet-container { background: #dde6ed; }

/* Custom markers */
.hospital-marker {
  border-radius: 50%; border: 2.5px solid white;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3); transition: transform 0.15s;
  display: flex; align-items: center; justify-content: center;
  font-size: 8px; font-weight: 700; color: white; font-family: 'Inter', sans-serif;
}
.hospital-marker:hover { transform: scale(1.2); z-index: 9999 !important; }
.hospital-marker.tier-1 { border-width: 3px; }

/* Map controls */
.map-controls {
  position: absolute; top: 12px; right: 12px; z-index: 500;
  display: flex; flex-direction: column; gap: 6px;
}
.map-ctrl-btn {
  width: 36px; height: 36px; background: white; border: none; border-radius: 6px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15); cursor: pointer; display: flex;
  align-items: center; justify-content: center; font-size: 16px;
  transition: all 0.15s; color: var(--jnj-navy);
}
.map-ctrl-btn:hover { background: #f0f7ff; }

/* â”€â”€ Right Drawer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.drawer {
  width: var(--drawer-width); background: white; position: absolute;
  top: 0; right: 0; height: 100%; z-index: 600;
  transform: translateX(100%); transition: transform 0.3s ease;
  box-shadow: -4px 0 16px rgba(0,0,0,0.1); display: flex; flex-direction: column;
  overflow: hidden;
}
.drawer.open { transform: translateX(0); }
.drawer-header {
  padding: 14px 16px; background: var(--jnj-navy); color: white;
  display: flex; align-items: center; justify-content: space-between;
}
.drawer-title { font-size: 14px; font-weight: 600; }
.drawer-close {
  width: 28px; height: 28px; border-radius: 50%; background: rgba(255,255,255,0.15);
  border: none; color: white; font-size: 16px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
}
.drawer-body { flex: 1; overflow-y: auto; padding: 16px; }
.drawer-body::-webkit-scrollbar { width: 5px; }
.drawer-body::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }

/* Drawer sections */
.drawer-section { margin-bottom: 20px; }
.drawer-section-title {
  font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.8px;
  color: #94a3b8; margin-bottom: 10px; padding-bottom: 6px;
  border-bottom: 1px solid #f1f5f9;
}
.detail-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
.detail-item { }
.detail-label { font-size: 10px; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px; }
.detail-value { font-size: 13px; font-weight: 600; color: var(--jnj-navy); }

/* Infrastructure gauge */
.infra-gauge-container { display: flex; align-items: center; gap: 16px; padding: 12px; background: #f8fafc; border-radius: 8px; }
.infra-gauge {
  width: 64px; height: 64px; border-radius: 50%; position: relative;
  display: flex; align-items: center; justify-content: center;
}
.infra-gauge-value { font-size: 20px; font-weight: 800; }
.infra-gauge-info { flex: 1; }
.infra-tier-badge {
  display: inline-block; padding: 3px 10px; border-radius: 4px;
  font-size: 11px; font-weight: 700; color: white; margin-bottom: 4px;
}
.infra-tier-desc { font-size: 12px; color: #64748b; }

/* Infrastructure checklist */
.infra-checklist { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
.infra-check-item {
  display: flex; align-items: center; gap: 8px; padding: 6px 10px;
  background: #f8fafc; border-radius: 6px; font-size: 12px;
}
.infra-check-icon { font-size: 14px; flex-shrink: 0; }
.infra-check-icon.yes { color: #059669; }
.infra-check-icon.no { color: #dc2626; opacity: 0.4; }
.infra-check-label { color: #475569; font-weight: 500; }

/* Prevalence bars */
.prev-bar-container { margin-bottom: 8px; }
.prev-bar-label { display: flex; justify-content: space-between; font-size: 11px; margin-bottom: 3px; }
.prev-bar-name { color: #64748b; }
.prev-bar-val { font-weight: 600; color: var(--jnj-navy); }
.prev-bar { height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden; }
.prev-bar-fill { height: 100%; border-radius: 4px; transition: width 0.5s ease; }

/* Epi summary cards */
.epi-summary { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 12px; }
.epi-card {
  text-align: center; padding: 10px 6px; background: #f8fafc; border-radius: 8px;
  border: 1px solid #e2e8f0;
}
.epi-card-value { font-size: 18px; font-weight: 800; color: var(--jnj-navy); }
.epi-card-label { font-size: 9px; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px; margin-top: 2px; }

/* Geographic access badge */
.geo-access-badge {
  display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px;
  border-radius: 6px; font-size: 12px; font-weight: 600; margin-bottom: 8px;
}
.geo-access-badge.local { background: #ecfdf5; color: #059669; }
.geo-access-badge.short { background: #eff6ff; color: #2563eb; }
.geo-access-badge.long { background: #fffbeb; color: #d97706; }
.geo-access-badge.flight { background: #fef2f2; color: #dc2626; }

/* â”€â”€ Calendar Panel â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.calendar-panel {
  width: var(--drawer-width); background: white; position: absolute;
  top: 0; right: 0; height: 100%; z-index: 600;
  transform: translateX(100%); transition: transform 0.3s ease;
  box-shadow: -4px 0 16px rgba(0,0,0,0.1); display: flex; flex-direction: column;
}
.calendar-panel.open { transform: translateX(0); }
.calendar-header {
  padding: 14px 16px; background: var(--jnj-navy); color: white;
  display: flex; align-items: center; justify-content: space-between;
}
.calendar-body { flex: 1; overflow-y: auto; padding: 16px; }
.calendar-body::-webkit-scrollbar { width: 5px; }
.calendar-body::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }

.cal-month { margin-bottom: 20px; }
.cal-month-title {
  font-size: 13px; font-weight: 700; color: var(--jnj-navy); margin-bottom: 8px;
  padding-bottom: 4px; border-bottom: 2px solid var(--jnj-navy);
}
.cal-week { display: grid; grid-template-columns: 60px 1fr; gap: 4px; margin-bottom: 4px; }
.cal-week-label { font-size: 10px; color: #94a3b8; padding-top: 4px; }
.cal-week-entries { display: flex; flex-wrap: wrap; gap: 3px; }
.cal-entry {
  padding: 3px 8px; border-radius: 4px; font-size: 10px; font-weight: 500;
  display: flex; align-items: center; gap: 4px; background: #f1f5f9;
}
.cal-dept-dot { width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0; }
.cadence-legend { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 12px; }
.cadence-legend-item { display: flex; align-items: center; gap: 4px; font-size: 10px; color: #64748b; }

/* â”€â”€ Bottom Analytics Bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.analytics-bar {
  height: var(--analytics-height); background: white; border-top: 1px solid #e2e8f0;
  display: flex; align-items: center; padding: 0 20px; gap: 20px; z-index: 500;
  box-shadow: 0 -2px 8px rgba(0,0,0,0.05);
}
.analytics-item { display: flex; flex-direction: column; align-items: center; }
.analytics-label { font-size: 9px; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600; }
.analytics-value { font-size: 15px; font-weight: 700; color: var(--jnj-navy); }
.analytics-divider { width: 1px; height: 36px; background: #e2e8f0; }
.analytics-mini-bar { display: flex; gap: 2px; align-items: flex-end; height: 28px; }
.analytics-mini-bar-item { width: 18px; border-radius: 2px 2px 0 0; position: relative; }
.analytics-mini-bar-label {
  position: absolute; bottom: -14px; left: 50%; transform: translateX(-50%);
  font-size: 8px; color: #94a3b8; white-space: nowrap;
}

/* â”€â”€ Toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.toast-container {
  position: fixed; bottom: 80px; right: 20px; z-index: 9999;
  display: flex; flex-direction: column; gap: 8px;
}
.toast {
  padding: 10px 16px; border-radius: 8px; background: var(--jnj-navy);
  color: white; font-size: 12px; font-weight: 500;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2); opacity: 0; transform: translateY(10px);
  transition: all 0.3s ease; max-width: 300px;
}
.toast.show { opacity: 1; transform: translateY(0); }

/* â”€â”€ Popup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.leaflet-popup-content-wrapper {
  border-radius: 10px; box-shadow: 0 4px 16px rgba(0,0,0,0.15); padding: 0;
}
.leaflet-popup-content { margin: 0; min-width: 240px; }
.popup-inner { padding: 14px; }
.popup-name { font-size: 14px; font-weight: 700; color: var(--jnj-navy); margin-bottom: 4px; }
.popup-cert { font-size: 11px; margin-bottom: 8px; }
.popup-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
.popup-stat-label { font-size: 10px; color: #94a3b8; }
.popup-stat-value { font-size: 13px; font-weight: 600; color: var(--jnj-navy); }
.popup-btn {
  display: block; width: 100%; padding: 8px; background: var(--jnj-navy);
  color: white; border: none; border-radius: 6px; font-size: 12px;
  font-weight: 600; cursor: pointer; margin-top: 10px; font-family: inherit;
  transition: background 0.15s;
}
.popup-btn:hover { background: var(--jnj-blue); }

/* â”€â”€ Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media (max-width: 1200px) {
  :root { --sidebar-width: 320px; --drawer-width: 400px; }
}
@media (max-width: 1024px) {
  :root { --sidebar-width: 280px; --drawer-width: 100%; }
  .analytics-bar { gap: 12px; padding: 0 12px; overflow-x: auto; }
  .header-rep { display: none; }
}
</style>
</head>
<body>

<!-- â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="header">
  <div class="header-logo">
    <div class="jnj-mark">J&J</div>
    MEDTECH NEUROVASCULAR
  </div>
  <div class="header-territory">Florida / Georgia</div>
  <div class="header-rep"><strong>Andrew Payne</strong> Â· CAS Â· Jacksonville, FL</div>
  <div class="header-actions">
    <button class="header-btn" id="btnFitAll" title="Fit All Markers">âŠž Fit All</button>
    <button class="header-btn" id="btnCalendar" title="Cadence Calendar">ðŸ“… Calendar</button>
  </div>
</div>

<!-- â”€â”€ Main Container â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="main-container">

  <!-- Left Sidebar -->
  <div class="sidebar">
    <div class="sidebar-header">
      <input type="text" class="sidebar-search" id="searchInput" placeholder="Search hospitals..." />
    </div>
    <div class="sidebar-filters" id="filterBar">
      <button class="filter-btn active" data-filter="all">All (21)</button>
      <button class="filter-btn" data-filter="CSC">CSC (11)</button>
      <button class="filter-btn" data-filter="PSC">PSC (9)</button>
      <button class="filter-btn" data-filter="TSC">TSC (1)</button>
      
    </div>
    <div class="sidebar-sort">
      Sort by:
      <select class="sort-select" id="sortSelect">
        <option value="infrastructure_score">Infra Score â†“</option>
        <option value="strokes_yr">Strokes/Yr â†“</option>
        <option value="lvo_volume">LVO Volume â†“</option>
        <option value="beds">Beds â†“</option>
        <option value="name">Name A-Z</option>
      </select>
    </div>
    <div class="sidebar-list" id="hospitalList"></div>
  </div>

  <!-- Map -->
  <div class="map-container">
    <div id="map"></div>
    <div class="map-controls">
      <button class="map-ctrl-btn" id="btnZoomIn" title="Zoom In">+</button>
      <button class="map-ctrl-btn" id="btnZoomOut" title="Zoom Out">âˆ’</button>
    </div>

    <!-- Right Drawer (Account Detail) -->
    <div class="drawer" id="accountDrawer">
      <div class="drawer-header">
        <span class="drawer-title" id="drawerTitle">Account Detail</span>
        <button class="drawer-close" id="drawerClose">âœ•</button>
      </div>
      <div class="drawer-body" id="drawerBody"></div>
    </div>

    <!-- Calendar Panel -->
    <div class="calendar-panel" id="calendarPanel">
      <div class="calendar-header">
        <span class="drawer-title">Cadence Calendar â€” Marâ€“Aug 2026</span>
        <button class="drawer-close" id="calendarClose">âœ•</button>
      </div>
      <div class="calendar-body" id="calendarBody"></div>
    </div>
  </div>
</div>

<!-- â”€â”€ Bottom Analytics Bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="analytics-bar">
  <div class="analytics-item">
    <span class="analytics-label">Hospitals</span>
    <span class="analytics-value">21</span>
  </div>
  <div class="analytics-divider"></div>
  <div class="analytics-item">
    <span class="analytics-label">Total Beds</span>
    <span class="analytics-value">13,493</span>
  </div>
  <div class="analytics-divider"></div>
  <div class="analytics-item">
    <span class="analytics-label">Strokes/Yr</span>
    <span class="analytics-value">9,700</span>
  </div>
  <div class="analytics-divider"></div>
  <div class="analytics-item">
    <span class="analytics-label">Est. LVO</span>
    <span class="analytics-value">9,725</span>
  </div>
  <div class="analytics-divider"></div>
  <div class="analytics-item">
    <span class="analytics-label">MT Eligible</span>
    <span class="analytics-value">6,807</span>
  </div>
  <div class="analytics-divider"></div>
  <div class="analytics-item">
    <span class="analytics-label">Certs</span>
    <span class="analytics-value" style="font-size:11px;">CSC:11 Â· PSC:9 Â· TSC:1</span>
  </div>
  <div class="analytics-divider"></div>
  <div class="analytics-item">
    <span class="analytics-label">Capabilities</span>
    <span class="analytics-value" style="font-size:11px;">24/7 MT:11 Â· NICU:19 Â· Tele:21</span>
  </div>
  <div class="analytics-divider"></div>
  <div class="analytics-item">
    <span class="analytics-label">Tiers</span>
    <span class="analytics-value" style="font-size:12px;">T1:7 Â· T2:7 Â· T3:7</span>
  </div>
  <div class="analytics-divider"></div>
  <div class="analytics-item">
    <span class="analytics-label">Avg Infra</span>
    <span class="analytics-value">74</span>
  </div>
  <div style="flex:1;"></div>
  <div class="analytics-item" style="opacity:0.5;">
    <span class="analytics-label">Generated</span>
    <span style="font-size:10px; color:#94a3b8;">February 20, 2026</span>
  </div>
</div>

<!-- Toast container -->
<div class="toast-container" id="toastContainer"></div>

<!-- â”€â”€ JavaScript â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<script>
// â”€â”€ Data â”€â”€
const HOSPITALS = [{"name": "AdventHealth Orlando", "short_name": "AdventHealth ORL", "address": "601 E Rollins St, Orlando, FL 32803", "city": "Orlando", "state": "FL", "county": "Orange County, FL", "lat": 28.5727, "lng": -81.3627, "phone": "(407) 303-5600", "ir_phone": "(407) 303-5800", "beds": 2856, "affiliation": "AdventHealth", "gpo": "Premier", "cert": "CSC", "cert_body": "Joint Commission", "cert_color": "#EB1700", "cert_label": "Comprehensive Stroke Center", "nsg_fellowship": true, "nir_fellowship": true, "strokes_yr": 980, "pop_total": 2100000, "pop_65_plus": 336000, "pop_under_65": 1764000, "pop_65_pct": 16.0, "effective_pop": 2604000, "median_age": 35.8, "life_expectancy": 79.1, "ischemic_volume": 5625, "lvo_volume": 1181, "mt_eligible": 827, "avm_aneurysm_volume": 312, "hemorrhagic_volume": 312, "sah_volume": 16, "ich_volume": 250, "hemorrhagic_other": 47, "total_stroke_volume": 5937, "afib_prevalence": 3.4, "afib_count": 71400, "mmae_score": 82.0, "clinical_benefit_radius": 50.0, "cah": false, "telestroke": true, "thrombectomy_24_7": true, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 98, "clinical_tier": 1, "clinical_tier_label": "High Complexity Hub", "medevac_available": true, "road_access": true, "geographic_access": "Local", "travel_miles": 3.4, "travel_time_min": 4, "closest_team_member": "Mark", "comment": "Largest hospital in territory \u2014 2,856 beds, massive catchment"}, {"name": "Baptist Medical Center Jacksonville", "short_name": "Baptist Jax", "address": "800 Prudential Dr, Jacksonville, FL 32207", "city": "Jacksonville", "state": "FL", "county": "Duval County, FL", "lat": 30.3187, "lng": -81.6568, "phone": "(904) 202-2000", "ir_phone": "(904) 202-2100", "beds": 972, "affiliation": "Baptist Health", "gpo": "Vizient", "cert": "CSC", "cert_body": "Joint Commission", "cert_color": "#EB1700", "cert_label": "Comprehensive Stroke Center", "nsg_fellowship": true, "nir_fellowship": true, "strokes_yr": 900, "pop_total": 1750000, "pop_65_plus": 310000, "pop_under_65": 1440000, "pop_65_pct": 17.7, "effective_pop": 2215000, "median_age": 37.5, "life_expectancy": 77.4, "ischemic_volume": 4784, "lvo_volume": 1005, "mt_eligible": 704, "avm_aneurysm_volume": 266, "hemorrhagic_volume": 266, "sah_volume": 13, "ich_volume": 213, "hemorrhagic_other": 40, "total_stroke_volume": 5050, "afib_prevalence": 3.2, "afib_count": 56000, "mmae_score": 72.0, "clinical_benefit_radius": 45.0, "cah": false, "telestroke": true, "thrombectomy_24_7": true, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 97, "clinical_tier": 1, "clinical_tier_label": "High Complexity Hub", "medevac_available": true, "road_access": true, "geographic_access": "Local", "travel_miles": 1.2, "travel_time_min": 1, "closest_team_member": "Andrew Payne", "comment": "Flagship CSC \u2014 largest stroke program in territory"}, {"name": "Shands Teaching Hospital and Clinics (UF Health Shands)", "short_name": "UF Shands GNV", "address": "1600 SW Archer Rd, Gainesville, FL 32610", "city": "Gainesville", "state": "FL", "county": "Alachua County, FL", "lat": 29.64, "lng": -82.3443, "phone": "(352) 265-0111", "ir_phone": "(352) 265-0200", "beds": 1162, "affiliation": "University of Florida Health", "gpo": "Vizient", "cert": "CSC", "cert_body": "Joint Commission", "cert_color": "#EB1700", "cert_label": "Comprehensive Stroke Center", "nsg_fellowship": true, "nir_fellowship": true, "strokes_yr": 850, "pop_total": 950000, "pop_65_plus": 152000, "pop_under_65": 798000, "pop_65_pct": 16.0, "effective_pop": 1178000, "median_age": 32.1, "life_expectancy": 78.6, "ischemic_volume": 2544, "lvo_volume": 534, "mt_eligible": 374, "avm_aneurysm_volume": 141, "hemorrhagic_volume": 141, "sah_volume": 7, "ich_volume": 113, "hemorrhagic_other": 21, "total_stroke_volume": 2685, "afib_prevalence": 2.8, "afib_count": 26600, "mmae_score": 78.0, "clinical_benefit_radius": 50.0, "cah": false, "telestroke": true, "thrombectomy_24_7": true, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 97, "clinical_tier": 1, "clinical_tier_label": "High Complexity Hub", "medevac_available": true, "road_access": true, "geographic_access": "Short", "travel_miles": 82.1, "travel_time_min": 90, "closest_team_member": "Andrew Payne", "comment": "Academic flagship \u2014 full neurosurgery & NIR fellowship programs"}, {"name": "Shands Jacksonville Medical Center (UF Health Jax)", "short_name": "UF Health Jax", "address": "655 W 8th St, Jacksonville, FL 32209", "city": "Jacksonville", "state": "FL", "county": "Duval County, FL", "lat": 30.3554, "lng": -81.6721, "phone": "(904) 244-0411", "ir_phone": "(904) 244-0500", "beds": 695, "affiliation": "University of Florida Health", "gpo": "Vizient", "cert": "CSC", "cert_body": "Joint Commission", "cert_color": "#EB1700", "cert_label": "Comprehensive Stroke Center", "nsg_fellowship": true, "nir_fellowship": true, "strokes_yr": 750, "pop_total": 1400000, "pop_65_plus": 238000, "pop_under_65": 1162000, "pop_65_pct": 17.0, "effective_pop": 1757000, "median_age": 36.8, "life_expectancy": 76.9, "ischemic_volume": 3795, "lvo_volume": 797, "mt_eligible": 558, "avm_aneurysm_volume": 211, "hemorrhagic_volume": 211, "sah_volume": 11, "ich_volume": 169, "hemorrhagic_other": 32, "total_stroke_volume": 4006, "afib_prevalence": 2.9, "afib_count": 40600, "mmae_score": 68.0, "clinical_benefit_radius": 40.0, "cah": false, "telestroke": true, "thrombectomy_24_7": true, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 96, "clinical_tier": 1, "clinical_tier_label": "High Complexity Hub", "medevac_available": true, "road_access": true, "geographic_access": "Local", "travel_miles": 2.4, "travel_time_min": 3, "closest_team_member": "Andrew Payne", "comment": "Academic medical center with active NIR fellowship"}, {"name": "Saint Joseph's Hospital", "short_name": "St. Joseph's Tampa", "address": "3001 W Dr Martin Luther King Jr Blvd, Tampa, FL 33607", "city": "Tampa", "state": "FL", "county": "Hillsborough County, FL", "lat": 27.9632, "lng": -82.4874, "phone": "(813) 870-4000", "ir_phone": "(813) 870-4100", "beds": 897, "affiliation": "BayCare Health System", "gpo": "Premier", "cert": "CSC", "cert_body": "Joint Commission", "cert_color": "#EB1700", "cert_label": "Comprehensive Stroke Center", "nsg_fellowship": true, "nir_fellowship": true, "strokes_yr": 710, "pop_total": 1500000, "pop_65_plus": 255000, "pop_under_65": 1245000, "pop_65_pct": 17.0, "effective_pop": 1882500, "median_age": 36.2, "life_expectancy": 78.0, "ischemic_volume": 4066, "lvo_volume": 854, "mt_eligible": 598, "avm_aneurysm_volume": 226, "hemorrhagic_volume": 226, "sah_volume": 11, "ich_volume": 181, "hemorrhagic_other": 34, "total_stroke_volume": 4292, "afib_prevalence": 3.1, "afib_count": 46500, "mmae_score": 74.0, "clinical_benefit_radius": 45.0, "cah": false, "telestroke": true, "thrombectomy_24_7": true, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 95, "clinical_tier": 1, "clinical_tier_label": "High Complexity Hub", "medevac_available": true, "road_access": true, "geographic_access": "Short", "travel_miles": 101.8, "travel_time_min": 111, "closest_team_member": "Mark", "comment": "Major Tampa Bay CSC \u2014 Pepin Heart & Vascular Institute"}, {"name": "AdventHealth CSC", "short_name": "AdventHealth CSC", "address": "601 E Rollins St, Orlando, FL 32803", "city": "Orlando", "state": "FL", "county": "Orange County, FL", "lat": 28.5597, "lng": -81.3628, "phone": "(407) 303-5600", "ir_phone": "(407) 303-5700", "beds": 547, "affiliation": "AdventHealth", "gpo": "Premier", "cert": "CSC", "cert_body": "Joint Commission", "cert_color": "#EB1700", "cert_label": "Comprehensive Stroke Center", "nsg_fellowship": true, "nir_fellowship": true, "strokes_yr": 620, "pop_total": 1200000, "pop_65_plus": 192000, "pop_under_65": 1008000, "pop_65_pct": 16.0, "effective_pop": 1488000, "median_age": 36.4, "life_expectancy": 78.8, "ischemic_volume": 3214, "lvo_volume": 675, "mt_eligible": 472, "avm_aneurysm_volume": 179, "hemorrhagic_volume": 179, "sah_volume": 9, "ich_volume": 143, "hemorrhagic_other": 27, "total_stroke_volume": 3393, "afib_prevalence": 3.0, "afib_count": 36000, "mmae_score": 70.0, "clinical_benefit_radius": 40.0, "cah": false, "telestroke": true, "thrombectomy_24_7": true, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 94, "clinical_tier": 1, "clinical_tier_label": "High Complexity Hub", "medevac_available": true, "road_access": true, "geographic_access": "Local", "travel_miles": 2.3, "travel_time_min": 3, "closest_team_member": "Mark", "comment": "AdventHealth system CSC \u2014 strong neuro IR program"}, {"name": "UF Health Heart & Vascular and Neuromedicine Hospitals", "short_name": "UF Neuro Hospital", "address": "1505 SW Archer Rd, Gainesville, FL 32608", "city": "Gainesville", "state": "FL", "county": "Alachua County, FL", "lat": 29.6375, "lng": -82.35, "phone": "(352) 265-8000", "ir_phone": "(352) 265-8100", "beds": 216, "affiliation": "University of Florida Health", "gpo": "Vizient", "cert": "CSC", "cert_body": "Joint Commission", "cert_color": "#EB1700", "cert_label": "Comprehensive Stroke Center", "nsg_fellowship": true, "nir_fellowship": true, "strokes_yr": 480, "pop_total": 600000, "pop_65_plus": 96000, "pop_under_65": 504000, "pop_65_pct": 16.0, "effective_pop": 744000, "median_age": 32.1, "life_expectancy": 78.6, "ischemic_volume": 1607, "lvo_volume": 337, "mt_eligible": 236, "avm_aneurysm_volume": 89, "hemorrhagic_volume": 89, "sah_volume": 4, "ich_volume": 71, "hemorrhagic_other": 13, "total_stroke_volume": 1696, "afib_prevalence": 2.6, "afib_count": 15600, "mmae_score": 80.0, "clinical_benefit_radius": 40.0, "cah": false, "telestroke": true, "thrombectomy_24_7": true, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 93, "clinical_tier": 1, "clinical_tier_label": "High Complexity Hub", "medevac_available": true, "road_access": true, "geographic_access": "Short", "travel_miles": 82.5, "travel_time_min": 90, "closest_team_member": "Andrew Payne", "comment": "New dedicated neurovascular hospital \u2014 state-of-the-art hybrid ORs"}, {"name": "Mayo Clinic Jacksonville", "short_name": "Mayo Jax", "address": "4500 San Pablo Rd S, Jacksonville, FL 32224", "city": "Jacksonville", "state": "FL", "county": "Duval County, FL", "lat": 30.2617, "lng": -81.4408, "phone": "(904) 953-2000", "ir_phone": "(904) 953-2100", "beds": 304, "affiliation": "Mayo Clinic Health System", "gpo": "Mayo GPO", "cert": "CSC", "cert_body": "Joint Commission", "cert_color": "#EB1700", "cert_label": "Comprehensive Stroke Center", "nsg_fellowship": true, "nir_fellowship": true, "strokes_yr": 420, "pop_total": 900000, "pop_65_plus": 171000, "pop_under_65": 729000, "pop_65_pct": 19.0, "effective_pop": 1156500, "median_age": 42.1, "life_expectancy": 81.2, "ischemic_volume": 2498, "lvo_volume": 525, "mt_eligible": 368, "avm_aneurysm_volume": 139, "hemorrhagic_volume": 139, "sah_volume": 7, "ich_volume": 111, "hemorrhagic_other": 21, "total_stroke_volume": 2637, "afib_prevalence": 3.8, "afib_count": 34200, "mmae_score": 85.0, "clinical_benefit_radius": 50.0, "cah": false, "telestroke": true, "thrombectomy_24_7": true, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 92, "clinical_tier": 2, "clinical_tier_label": "Regional Center", "medevac_available": true, "road_access": true, "geographic_access": "Local", "travel_miles": 17.8, "travel_time_min": 19, "closest_team_member": "Andrew Payne", "comment": "Research-intensive \u2014 leading clinical trials enrollment"}, {"name": "Savannah Health Services LLC (Memorial Health)", "short_name": "Memorial Savannah", "address": "4700 Waters Ave, Savannah, GA 31404", "city": "Savannah", "state": "GA", "county": "Chatham County, GA", "lat": 32.0312, "lng": -81.0874, "phone": "(912) 350-8000", "ir_phone": "(912) 350-8200", "beds": 612, "affiliation": "HCA Healthcare", "gpo": "HealthTrust", "cert": "CSC", "cert_body": "Joint Commission", "cert_color": "#EB1700", "cert_label": "Comprehensive Stroke Center", "nsg_fellowship": true, "nir_fellowship": false, "strokes_yr": 580, "pop_total": 680000, "pop_65_plus": 108800, "pop_under_65": 571200, "pop_65_pct": 16.0, "effective_pop": 843200, "median_age": 35.7, "life_expectancy": 75.2, "ischemic_volume": 1821, "lvo_volume": 382, "mt_eligible": 267, "avm_aneurysm_volume": 101, "hemorrhagic_volume": 101, "sah_volume": 5, "ich_volume": 81, "hemorrhagic_other": 15, "total_stroke_volume": 1922, "afib_prevalence": 2.7, "afib_count": 18360, "mmae_score": 62.0, "clinical_benefit_radius": 35.0, "cah": false, "telestroke": true, "thrombectomy_24_7": true, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 86, "clinical_tier": 2, "clinical_tier_label": "Regional Center", "medevac_available": true, "road_access": true, "geographic_access": "Long", "travel_miles": 158.7, "travel_time_min": 173, "closest_team_member": "Andrew Payne", "comment": "Regional CSC hub for southeast Georgia"}, {"name": "Tallahassee Memorial HealthCare", "short_name": "TMH", "address": "1300 Miccosukee Rd, Tallahassee, FL 32308", "city": "Tallahassee", "state": "FL", "county": "Leon County, FL", "lat": 30.4408, "lng": -84.243, "phone": "(850) 431-1155", "ir_phone": "(850) 431-1200", "beds": 772, "affiliation": "Tallahassee Memorial HealthCare", "gpo": "Premier", "cert": "CSC", "cert_body": "Joint Commission", "cert_color": "#EB1700", "cert_label": "Comprehensive Stroke Center", "nsg_fellowship": true, "nir_fellowship": false, "strokes_yr": 520, "pop_total": 550000, "pop_65_plus": 82500, "pop_under_65": 467500, "pop_65_pct": 15.0, "effective_pop": 673750, "median_age": 33.8, "life_expectancy": 77.5, "ischemic_volume": 1455, "lvo_volume": 306, "mt_eligible": 214, "avm_aneurysm_volume": 81, "hemorrhagic_volume": 81, "sah_volume": 4, "ich_volume": 65, "hemorrhagic_other": 12, "total_stroke_volume": 1536, "afib_prevalence": 2.4, "afib_count": 13200, "mmae_score": 58.0, "clinical_benefit_radius": 35.0, "cah": false, "telestroke": true, "thrombectomy_24_7": true, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 85, "clinical_tier": 2, "clinical_tier_label": "Regional Center", "medevac_available": true, "road_access": true, "geographic_access": "Long", "travel_miles": 200.7, "travel_time_min": 219, "closest_team_member": "Andrew Payne", "comment": "Only CSC between Jacksonville and Pensacola"}, {"name": "Halifax Hospital Medical Center (Halifax Health)", "short_name": "Halifax Health", "address": "303 N Clyde Morris Blvd, Daytona Beach, FL 32114", "city": "Daytona Beach", "state": "FL", "county": "Volusia County, FL", "lat": 29.2184, "lng": -81.0484, "phone": "(386) 254-4000", "ir_phone": "(386) 254-4100", "beds": 678, "affiliation": "Halifax Health", "gpo": "Vizient", "cert": "CSC", "cert_body": "Joint Commission", "cert_color": "#EB1700", "cert_label": "Comprehensive Stroke Center", "nsg_fellowship": true, "nir_fellowship": false, "strokes_yr": 490, "pop_total": 580000, "pop_65_plus": 110200, "pop_under_65": 469800, "pop_65_pct": 19.0, "effective_pop": 745300, "median_age": 43.6, "life_expectancy": 77.1, "ischemic_volume": 1610, "lvo_volume": 338, "mt_eligible": 237, "avm_aneurysm_volume": 89, "hemorrhagic_volume": 89, "sah_volume": 4, "ich_volume": 71, "hemorrhagic_other": 13, "total_stroke_volume": 1699, "afib_prevalence": 3.0, "afib_count": 17400, "mmae_score": 60.0, "clinical_benefit_radius": 35.0, "cah": false, "telestroke": true, "thrombectomy_24_7": true, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 85, "clinical_tier": 2, "clinical_tier_label": "Regional Center", "medevac_available": true, "road_access": true, "geographic_access": "Short", "travel_miles": 66.4, "travel_time_min": 72, "closest_team_member": "Mark", "comment": "Central FL east coast CSC \u2014 high retiree catchment"}, {"name": "Saint Vincent's Medical Center Riverside", "short_name": "St. Vincent's Jax", "address": "1 Shircliff Way, Jacksonville, FL 32204", "city": "Jacksonville", "state": "FL", "county": "Duval County, FL", "lat": 30.3136, "lng": -81.6892, "phone": "(904) 308-7300", "ir_phone": "", "beds": 528, "affiliation": "Ascension Health", "gpo": "HPG", "cert": "PSC", "cert_body": "DNV", "cert_color": "#F59E0B", "cert_label": "Primary Stroke Center", "nsg_fellowship": false, "nir_fellowship": false, "strokes_yr": 340, "pop_total": 850000, "pop_65_plus": 144500, "pop_under_65": 705500, "pop_65_pct": 17.0, "effective_pop": 1066750, "median_age": 39.2, "life_expectancy": 78.1, "ischemic_volume": 2304, "lvo_volume": 484, "mt_eligible": 339, "avm_aneurysm_volume": 128, "hemorrhagic_volume": 128, "sah_volume": 6, "ich_volume": 102, "hemorrhagic_other": 19, "total_stroke_volume": 2432, "afib_prevalence": 2.5, "afib_count": 21250, "mmae_score": 55.0, "clinical_benefit_radius": 30.0, "cah": false, "telestroke": true, "thrombectomy_24_7": false, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 56, "clinical_tier": 2, "clinical_tier_label": "Regional Center", "medevac_available": false, "road_access": true, "geographic_access": "Local", "travel_miles": 3.1, "travel_time_min": 3, "closest_team_member": "Andrew Payne", "comment": "Growing stroke program under new medical director"}, {"name": "Malcom Randall VA Medical Center", "short_name": "VA Gainesville", "address": "1601 SW Archer Rd, Gainesville, FL 32608", "city": "Gainesville", "state": "FL", "county": "Alachua County, FL", "lat": 29.6395, "lng": -82.3455, "phone": "(352) 376-1611", "ir_phone": "", "beds": 421, "affiliation": "US Dept of Veterans Affairs", "gpo": "VA FSS", "cert": "PSC", "cert_body": "Joint Commission", "cert_color": "#F59E0B", "cert_label": "Primary Stroke Center", "nsg_fellowship": false, "nir_fellowship": false, "strokes_yr": 310, "pop_total": 620000, "pop_65_plus": 167400, "pop_under_65": 452600, "pop_65_pct": 27.0, "effective_pop": 871100, "median_age": 62.5, "life_expectancy": 74.8, "ischemic_volume": 1882, "lvo_volume": 395, "mt_eligible": 276, "avm_aneurysm_volume": 105, "hemorrhagic_volume": 105, "sah_volume": 5, "ich_volume": 84, "hemorrhagic_other": 16, "total_stroke_volume": 1987, "afib_prevalence": 4.2, "afib_count": 26040, "mmae_score": 52.0, "clinical_benefit_radius": 30.0, "cah": false, "telestroke": true, "thrombectomy_24_7": false, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": true, "infrastructure_score": 56, "clinical_tier": 2, "clinical_tier_label": "Regional Center", "medevac_available": true, "road_access": true, "geographic_access": "Short", "travel_miles": 82.2, "travel_time_min": 90, "closest_team_member": "Andrew Payne", "comment": "VA facility \u2014 very high 65+ population, transfers complex cases to UF Shands"}, {"name": "North Florida Regional Medical Center", "short_name": "N FL Regional", "address": "6500 W Newberry Rd, Gainesville, FL 32605", "city": "Gainesville", "state": "FL", "county": "Alachua County, FL", "lat": 29.6661, "lng": -82.4146, "phone": "(352) 333-4000", "ir_phone": "", "beds": 510, "affiliation": "HCA Healthcare", "gpo": "HealthTrust", "cert": "PSC", "cert_body": "Joint Commission", "cert_color": "#F59E0B", "cert_label": "Primary Stroke Center", "nsg_fellowship": false, "nir_fellowship": false, "strokes_yr": 290, "pop_total": 480000, "pop_65_plus": 81600, "pop_under_65": 398400, "pop_65_pct": 17.0, "effective_pop": 602400, "median_age": 34.5, "life_expectancy": 77.9, "ischemic_volume": 1301, "lvo_volume": 273, "mt_eligible": 191, "avm_aneurysm_volume": 72, "hemorrhagic_volume": 72, "sah_volume": 4, "ich_volume": 58, "hemorrhagic_other": 11, "total_stroke_volume": 1373, "afib_prevalence": 2.2, "afib_count": 10560, "mmae_score": 48.0, "clinical_benefit_radius": 25.0, "cah": false, "telestroke": true, "thrombectomy_24_7": false, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 56, "clinical_tier": 2, "clinical_tier_label": "Regional Center", "medevac_available": false, "road_access": true, "geographic_access": "Short", "travel_miles": 84.1, "travel_time_min": 92, "closest_team_member": "Andrew Payne", "comment": "HCA facility \u2014 competes with UF Shands locally"}, {"name": "Memorial Hospital Jacksonville", "short_name": "Memorial Jax", "address": "3625 University Blvd S, Jacksonville, FL 32216", "city": "Jacksonville", "state": "FL", "county": "Duval County, FL", "lat": 30.2843, "lng": -81.6021, "phone": "(904) 702-6111", "ir_phone": "", "beds": 453, "affiliation": "HCA Healthcare", "gpo": "HealthTrust", "cert": "PSC", "cert_body": "Joint Commission", "cert_color": "#F59E0B", "cert_label": "Primary Stroke Center", "nsg_fellowship": false, "nir_fellowship": false, "strokes_yr": 280, "pop_total": 700000, "pop_65_plus": 119000, "pop_under_65": 581000, "pop_65_pct": 17.0, "effective_pop": 878500, "median_age": 38.4, "life_expectancy": 77.8, "ischemic_volume": 1898, "lvo_volume": 399, "mt_eligible": 279, "avm_aneurysm_volume": 105, "hemorrhagic_volume": 105, "sah_volume": 5, "ich_volume": 84, "hemorrhagic_other": 16, "total_stroke_volume": 2003, "afib_prevalence": 2.1, "afib_count": 14700, "mmae_score": 48.0, "clinical_benefit_radius": 25.0, "cah": false, "telestroke": true, "thrombectomy_24_7": false, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 56, "clinical_tier": 3, "clinical_tier_label": "Basic Capability", "medevac_available": false, "road_access": true, "geographic_access": "Local", "travel_miles": 6.0, "travel_time_min": 7, "closest_team_member": "Andrew Payne", "comment": ""}, {"name": "HCA Florida Lawnwood Hospital", "short_name": "HCA Lawnwood", "address": "1700 S 23rd St, Fort Pierce, FL 34950", "city": "Fort Pierce", "state": "FL", "county": "St. Lucie County, FL", "lat": 27.4355, "lng": -80.3453, "phone": "(772) 461-4000", "ir_phone": "", "beds": 380, "affiliation": "HCA Healthcare", "gpo": "HealthTrust", "cert": "PSC", "cert_body": "Joint Commission", "cert_color": "#F59E0B", "cert_label": "Primary Stroke Center", "nsg_fellowship": false, "nir_fellowship": false, "strokes_yr": 250, "pop_total": 420000, "pop_65_plus": 88200, "pop_under_65": 331800, "pop_65_pct": 21.0, "effective_pop": 552300, "median_age": 42.7, "life_expectancy": 77.0, "ischemic_volume": 1193, "lvo_volume": 251, "mt_eligible": 176, "avm_aneurysm_volume": 66, "hemorrhagic_volume": 66, "sah_volume": 3, "ich_volume": 53, "hemorrhagic_other": 10, "total_stroke_volume": 1259, "afib_prevalence": 2.6, "afib_count": 10920, "mmae_score": 45.0, "clinical_benefit_radius": 25.0, "cah": false, "telestroke": true, "thrombectomy_24_7": false, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 56, "clinical_tier": 3, "clinical_tier_label": "Basic Capability", "medevac_available": true, "road_access": true, "geographic_access": "Long", "travel_miles": 128.6, "travel_time_min": 140, "closest_team_member": "Mark", "comment": "Treasure Coast stroke center \u2014 high 65+ population"}, {"name": "Candler General Hospital", "short_name": "Candler Savannah", "address": "5353 Reynolds St, Savannah, GA 31405", "city": "Savannah", "state": "GA", "county": "Chatham County, GA", "lat": 32.0098, "lng": -81.1179, "phone": "(912) 819-6000", "ir_phone": "", "beds": 384, "affiliation": "St. Joseph's/Candler Health System", "gpo": "Premier", "cert": "PSC", "cert_body": "Joint Commission", "cert_color": "#F59E0B", "cert_label": "Primary Stroke Center", "nsg_fellowship": false, "nir_fellowship": false, "strokes_yr": 220, "pop_total": 380000, "pop_65_plus": 64600, "pop_under_65": 315400, "pop_65_pct": 17.0, "effective_pop": 476900, "median_age": 37.2, "life_expectancy": 75.8, "ischemic_volume": 1030, "lvo_volume": 216, "mt_eligible": 151, "avm_aneurysm_volume": 57, "hemorrhagic_volume": 57, "sah_volume": 3, "ich_volume": 46, "hemorrhagic_other": 9, "total_stroke_volume": 1087, "afib_prevalence": 2.3, "afib_count": 8740, "mmae_score": 42.0, "clinical_benefit_radius": 20.0, "cah": false, "telestroke": true, "thrombectomy_24_7": false, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 55, "clinical_tier": 3, "clinical_tier_label": "Basic Capability", "medevac_available": false, "road_access": true, "geographic_access": "Long", "travel_miles": 156.3, "travel_time_min": 170, "closest_team_member": "Andrew Payne", "comment": "Part of St. Joseph's/Candler system in Savannah"}, {"name": "Bay Medical Sacred Heart Health System", "short_name": "Bay Medical PC", "address": "615 N Bonita Ave, Panama City, FL 32401", "city": "Panama City", "state": "FL", "county": "Bay County, FL", "lat": 30.1697, "lng": -85.6636, "phone": "(850) 769-1511", "ir_phone": "", "beds": 323, "affiliation": "Ascension/Sacred Heart", "gpo": "HPG", "cert": "PSC", "cert_body": "DNV", "cert_color": "#F59E0B", "cert_label": "Primary Stroke Center", "nsg_fellowship": false, "nir_fellowship": false, "strokes_yr": 190, "pop_total": 280000, "pop_65_plus": 47600, "pop_under_65": 232400, "pop_65_pct": 17.0, "effective_pop": 351400, "median_age": 39.8, "life_expectancy": 76.3, "ischemic_volume": 759, "lvo_volume": 159, "mt_eligible": 111, "avm_aneurysm_volume": 42, "hemorrhagic_volume": 42, "sah_volume": 2, "ich_volume": 34, "hemorrhagic_other": 6, "total_stroke_volume": 801, "afib_prevalence": 1.9, "afib_count": 5320, "mmae_score": 38.0, "clinical_benefit_radius": 20.0, "cah": false, "telestroke": true, "thrombectomy_24_7": false, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": false, "infrastructure_score": 55, "clinical_tier": 3, "clinical_tier_label": "Basic Capability", "medevac_available": true, "road_access": true, "geographic_access": "Flight Required", "travel_miles": 311.3, "travel_time_min": 340, "closest_team_member": "Andrew Payne", "comment": "Panhandle region \u2014 nearest CSC is TMH (100+ mi)"}, {"name": "Shands Teaching Hospital (UF Health Rehab)", "short_name": "UF Shands Rehab", "address": "101 Newell Dr, Gainesville, FL 32611", "city": "Gainesville", "state": "FL", "county": "Alachua County, FL", "lat": 29.641, "lng": -82.3468, "phone": "(352) 265-0500", "ir_phone": "", "beds": 240, "affiliation": "University of Florida Health", "gpo": "Vizient", "cert": "PSC", "cert_body": "Joint Commission", "cert_color": "#F59E0B", "cert_label": "Primary Stroke Center", "nsg_fellowship": false, "nir_fellowship": false, "strokes_yr": 180, "pop_total": 450000, "pop_65_plus": 72000, "pop_under_65": 378000, "pop_65_pct": 16.0, "effective_pop": 558000, "median_age": 32.1, "life_expectancy": 78.6, "ischemic_volume": 1205, "lvo_volume": 253, "mt_eligible": 177, "avm_aneurysm_volume": 67, "hemorrhagic_volume": 67, "sah_volume": 3, "ich_volume": 54, "hemorrhagic_other": 10, "total_stroke_volume": 1272, "afib_prevalence": 2.0, "afib_count": 9000, "mmae_score": 38.0, "clinical_benefit_radius": 20.0, "cah": false, "telestroke": true, "thrombectomy_24_7": false, "tpa_available": true, "neuro_icu": true, "ct_scanner": true, "spoke_hospital": true, "infrastructure_score": 55, "clinical_tier": 3, "clinical_tier_label": "Basic Capability", "medevac_available": false, "road_access": true, "geographic_access": "Short", "travel_miles": 82.1, "travel_time_min": 90, "closest_team_member": "Andrew Payne", "comment": "Satellite campus of UF Health \u2014 spoke to main Shands CSC"}, {"name": "HCA Lake Monroe (Central Florida Regional)", "short_name": "HCA Lake Monroe", "address": "1401 W Seminole Blvd, Sanford, FL 32771", "city": "Sanford", "state": "FL", "county": "Seminole County, FL", "lat": 28.812, "lng": -81.2804, "phone": "(407) 321-4500", "ir_phone": "", "beds": 226, "affiliation": "HCA Healthcare", "gpo": "HealthTrust", "cert": "PSC", "cert_body": "Joint Commission", "cert_color": "#F59E0B", "cert_label": "Primary Stroke Center", "nsg_fellowship": false, "nir_fellowship": false, "strokes_yr": 160, "pop_total": 350000, "pop_65_plus": 63000, "pop_under_65": 287000, "pop_65_pct": 18.0, "effective_pop": 444500, "median_age": 39.5, "life_expectancy": 78.2, "ischemic_volume": 960, "lvo_volume": 202, "mt_eligible": 141, "avm_aneurysm_volume": 53, "hemorrhagic_volume": 53, "sah_volume": 3, "ich_volume": 42, "hemorrhagic_other": 8, "total_stroke_volume": 1013, "afib_prevalence": 2.3, "afib_count": 8050, "mmae_score": 35.0, "clinical_benefit_radius": 15.0, "cah": false, "telestroke": true, "thrombectomy_24_7": false, "tpa_available": true, "neuro_icu": false, "ct_scanner": true, "spoke_hospital": true, "infrastructure_score": 43, "clinical_tier": 3, "clinical_tier_label": "Basic Capability", "medevac_available": false, "road_access": true, "geographic_access": "Local", "travel_miles": 25.8, "travel_time_min": 28, "closest_team_member": "Mark", "comment": ""}, {"name": "Orange Park Medical Center", "short_name": "Orange Park", "address": "2001 Kingsley Ave, Orange Park, FL 32073", "city": "Orange Park", "state": "FL", "county": "Clay County, FL", "lat": 30.1665, "lng": -81.7178, "phone": "(904) 639-8500", "ir_phone": "", "beds": 317, "affiliation": "HCA Healthcare", "gpo": "HealthTrust", "cert": "TSC", "cert_body": "DNV", "cert_color": "#0077C8", "cert_label": "Thrombectomy-Capable Stroke Center", "nsg_fellowship": false, "nir_fellowship": false, "strokes_yr": 180, "pop_total": 280000, "pop_65_plus": 47600, "pop_under_65": 232400, "pop_65_pct": 17.0, "effective_pop": 351400, "median_age": 36.9, "life_expectancy": 77.2, "ischemic_volume": 759, "lvo_volume": 159, "mt_eligible": 111, "avm_aneurysm_volume": 42, "hemorrhagic_volume": 42, "sah_volume": 2, "ich_volume": 34, "hemorrhagic_other": 6, "total_stroke_volume": 801, "afib_prevalence": 1.8, "afib_count": 5040, "mmae_score": 35.0, "clinical_benefit_radius": 15.0, "cah": false, "telestroke": true, "thrombectomy_24_7": false, "tpa_available": true, "neuro_icu": false, "ct_scanner": true, "spoke_hospital": true, "infrastructure_score": 38, "clinical_tier": 3, "clinical_tier_label": "Basic Capability", "medevac_available": false, "road_access": true, "geographic_access": "Local", "travel_miles": 15.6, "travel_time_min": 17, "closest_team_member": "Andrew Payne", "comment": ""}];
const CONFIG = {
  repName: "Andrew Payne",
  repRole: "CAS",
  repBaseCity: "Jacksonville, FL",
  repBaseLat: 30.3322,
  repBaseLng: -81.6557,
  territoryName: "Florida / Georgia",
  mapCenterLat: 29.8,
  mapCenterLng: -81.8,
  mapZoom: 7,
  teamMembers: [{"city": "Orlando, FL", "lat": 28.5383, "lng": -81.3792, "name": "Mark", "role": "TM"}]
};

// â”€â”€ Map Setup â”€â”€
const map = L.map('map', {
  center: [CONFIG.mapCenterLat, CONFIG.mapCenterLng],
  zoom: CONFIG.mapZoom,
  zoomControl: false
});

L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
  attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OSM</a> &copy; <a href="https://carto.com/">CARTO</a>',
  subdomains: 'abcd', maxZoom: 19
}).addTo(map);

// â”€â”€ State â”€â”€
let markers = {};
let selectedHospital = null;
let activeFilter = 'all';
let activeSortKey = 'infrastructure_score';

// â”€â”€ Utility Functions â”€â”€
function fmt(n) { return n != null ? n.toLocaleString() : 'â€”'; }

function getCertColor(cert) {
  const colors = { CSC: '#EB1700', PSC: '#F59E0B', TSC: '#0077C8', TCC: '#0077C8' };
  return colors[cert] || '#6B7280';
}

function getTierColor(tier) {
  const colors = { 1: '#059669', 2: '#F59E0B', 3: '#6B7280' };
  return colors[tier] || '#6B7280';
}

function getGeoAccessClass(access) {
  const map = { 'Local': 'local', 'Short': 'short', 'Long': 'long', 'Flight Required': 'flight' };
  return map[access] || 'short';
}

function getGeoAccessIcon(access) {
  const map = { 'Local': 'ðŸ“', 'Short': 'ðŸš—', 'Long': 'ðŸš™', 'Flight Required': 'âœˆï¸' };
  return map[access] || 'ðŸ“';
}

function markerSize(strokes) {
  const maxStrokes = Math.max(...HOSPITALS.map(h => h.strokes_yr));
  const minSize = 18, maxSize = 42;
  if (maxStrokes === 0) return minSize;
  return Math.round(minSize + (strokes / maxStrokes) * (maxSize - minSize));
}

function checkIcon(val) {
  return val ? '<span class="infra-check-icon yes">âœ“</span>' : '<span class="infra-check-icon no">âœ—</span>';
}

// â”€â”€ Toast â”€â”€
function showToast(msg) {
  const container = document.getElementById('toastContainer');
  const toast = document.createElement('div');
  toast.className = 'toast';
  toast.textContent = msg;
  container.appendChild(toast);
  requestAnimationFrame(() => toast.classList.add('show'));
  setTimeout(() => {
    toast.classList.remove('show');
    setTimeout(() => toast.remove(), 300);
  }, 2500);
}

// â”€â”€ Create Markers â”€â”€
function createMarkers() {
  HOSPITALS.forEach((h, i) => {
    const size = markerSize(h.strokes_yr);
    const icon = L.divIcon({
      className: '',
      html: '<div class="hospital-marker' + (h.clinical_tier === 1 ? ' tier-1' : '') + '" style="width:' + size + 'px;height:' + size + 'px;background:' + getCertColor(h.cert) + ';">' + h.clinical_tier + '</div>',
      iconSize: [size, size],
      iconAnchor: [size/2, size/2]
    });

    const marker = L.marker([h.lat, h.lng], { icon }).addTo(map);
    marker.on('click', () => openPopup(h, marker));
    markers[i] = marker;
  });
}

function openPopup(h, marker) {
  const tierColor = getTierColor(h.clinical_tier);
  const popupHtml = '<div class="popup-inner">' +
    '<div class="popup-name">' + h.short_name + '</div>' +
    '<div class="popup-cert"><span class="badge badge-cert" style="background:' + getCertColor(h.cert) + '">' + (h.cert || 'None') + '</span> ' +
    '<span class="badge badge-tier" style="background:' + tierColor + '">Tier ' + h.clinical_tier + '</span></div>' +
    '<div class="popup-stats">' +
    '<div><div class="popup-stat-label">Beds</div><div class="popup-stat-value">' + fmt(h.beds) + '</div></div>' +
    '<div><div class="popup-stat-label">Strokes/Yr</div><div class="popup-stat-value">' + fmt(h.strokes_yr) + '</div></div>' +
    '<div><div class="popup-stat-label">Est. LVO</div><div class="popup-stat-value">' + fmt(h.lvo_volume) + '</div></div>' +
    '<div><div class="popup-stat-label">Infra Score</div><div class="popup-stat-value">' + h.infrastructure_score + '</div></div>' +
    '</div>' +
    '<button class="popup-btn" onclick="openDrawer(' + HOSPITALS.indexOf(h) + ')">View Full Profile â†’</button>' +
    '</div>';
  marker.bindPopup(popupHtml, { maxWidth: 280 }).openPopup();
}

// â”€â”€ Sidebar Cards â”€â”€
function renderCards() {
  const list = document.getElementById('hospitalList');
  let filtered = HOSPITALS.filter(h => {
    if (activeFilter === 'all') return true;
    if (activeFilter === 'TSC') return h.cert === 'TSC' || h.cert === 'TCC';
    return h.cert === activeFilter;
  });

  const searchTerm = document.getElementById('searchInput').value.toLowerCase();
  if (searchTerm) {
    filtered = filtered.filter(h =>
      h.name.toLowerCase().includes(searchTerm) ||
      h.short_name.toLowerCase().includes(searchTerm) ||
      h.city.toLowerCase().includes(searchTerm) ||
      h.affiliation.toLowerCase().includes(searchTerm)
    );
  }

  // Sort
  filtered.sort((a, b) => {
    if (activeSortKey === 'name') return a.name.localeCompare(b.name);
    return (b[activeSortKey] || 0) - (a[activeSortKey] || 0);
  });

  // Update marker visibility
  HOSPITALS.forEach((h, i) => {
    const visible = filtered.includes(h);
    if (markers[i]) {
      if (visible) markers[i].addTo(map);
      else map.removeLayer(markers[i]);
    }
  });

  list.innerHTML = filtered.map((h, rank) => {
    const idx = HOSPITALS.indexOf(h);
    const isSelected = selectedHospital === idx;
    const tierColor = getTierColor(h.clinical_tier);
    return '<div class="hospital-card' + (isSelected ? ' selected' : '') + '" onclick="selectHospital(' + idx + ')" data-idx="' + idx + '">' +
      '<div class="card-header">' +
      '<div class="card-rank">' + (rank + 1) + '</div>' +
      '<div class="card-name">' + h.name + '</div>' +
      '<div class="card-badges">' +
      '<span class="badge badge-cert" style="background:' + getCertColor(h.cert) + '">' + (h.cert || 'â€”') + '</span>' +
      '<span class="badge badge-tier" style="background:' + tierColor + '">T' + h.clinical_tier + '</span>' +
      '</div></div>' +
      '<div class="card-meta">' +
      '<span>' + fmt(h.beds) + ' beds</span>' +
      '<span>' + fmt(h.strokes_yr) + ' strokes/yr</span>' +
      '<span>' + h.affiliation + '</span>' +
      '</div>' +
      '<div style="display:flex;align-items:center;">' +
      '<div class="card-stats">' +
      '<div class="card-stat-item"><span class="card-stat-label">LVO: </span><span class="card-stat-value">' + fmt(h.lvo_volume) + '</span></div>' +
      '<div class="card-stat-item"><span class="card-stat-label">MT: </span><span class="card-stat-value">' + fmt(h.mt_eligible) + '</span></div>' +
      '</div>' +
      '<div class="card-infra-score" style="color:' + tierColor + '">IS: ' + h.infrastructure_score + '</div>' +
      '</div></div>';
  }).join('');
}

function selectHospital(idx) {
  selectedHospital = idx;
  const h = HOSPITALS[idx];
  renderCards();
  map.setView([h.lat, h.lng], Math.max(map.getZoom(), 10));
  if (markers[idx]) markers[idx].fire('click');
}

// â”€â”€ Account Drawer â”€â”€
function openDrawer(idx) {
  closeCalendar();
  const h = HOSPITALS[idx];
  selectedHospital = idx;
  document.getElementById('drawerTitle').textContent = h.short_name;

  const tierColor = getTierColor(h.clinical_tier);
  const certColor = getCertColor(h.cert);

  // Prevalence max values for bar scaling
  const maxLvo = Math.max(...HOSPITALS.map(x => x.lvo_volume || 0)) || 1;
  const maxIschemic = Math.max(...HOSPITALS.map(x => x.ischemic_volume || 0)) || 1;
  const maxHemorrhagic = Math.max(...HOSPITALS.map(x => x.hemorrhagic_volume || 0)) || 1;
  const maxAvm = Math.max(...HOSPITALS.map(x => x.avm_aneurysm_volume || 0)) || 1;

  const cadenceMap = { 1: 'Weekly', 2: 'Twice/Month', 3: 'Monthly' };

  let html = '';

  // â”€â”€ Hospital Profile â”€â”€
  html += '<div class="drawer-section">' +
    '<div class="drawer-section-title">Hospital Profile</div>' +
    '<div class="detail-grid">' +
    '<div class="detail-item"><div class="detail-label">Full Name</div><div class="detail-value" style="font-size:12px;">' + h.name + '</div></div>' +
    '<div class="detail-item"><div class="detail-label">Certification</div><div class="detail-value"><span class="badge badge-cert" style="background:' + certColor + '">' + (h.cert || 'None') + '</span>' + (h.cert_body ? ' <span style="font-size:10px;color:#94a3b8;">' + h.cert_body + '</span>' : '') + '</div></div>' +
    '<div class="detail-item"><div class="detail-label">Licensed Beds</div><div class="detail-value">' + fmt(h.beds) + '</div></div>' +
    '<div class="detail-item"><div class="detail-label">Strokes/Year</div><div class="detail-value">' + fmt(h.strokes_yr) + '</div></div>' +
    '<div class="detail-item"><div class="detail-label">Affiliation</div><div class="detail-value" style="font-size:12px;">' + h.affiliation + '</div></div>' +
    '<div class="detail-item"><div class="detail-label">GPO</div><div class="detail-value" style="font-size:12px;">' + h.gpo + '</div></div>' +
    '<div class="detail-item"><div class="detail-label">Phone</div><div class="detail-value" style="font-size:12px;">' + h.phone + '</div></div>' +
    '<div class="detail-item"><div class="detail-label">IR Phone</div><div class="detail-value" style="font-size:12px;">' + (h.ir_phone || 'â€”') + '</div></div>' +
    '<div class="detail-item"><div class="detail-label">Address</div><div class="detail-value" style="font-size:11px;">' + h.address + '</div></div>' +
    '<div class="detail-item"><div class="detail-label">County</div><div class="detail-value" style="font-size:12px;">' + h.county + '</div></div>' +
    '</div></div>';

  // â”€â”€ Clinical Programs â”€â”€
  html += '<div class="drawer-section">' +
    '<div class="drawer-section-title">Clinical Programs</div>' +
    '<div class="detail-grid">' +
    '<div class="detail-item"><div class="detail-label">Neurosurgery Fellowship</div><div class="detail-value">' + (h.nsg_fellowship ? 'âœ“ Yes' : 'âœ— No') + '</div></div>' +
    '<div class="detail-item"><div class="detail-label">Neuro IR Fellowship</div><div class="detail-value">' + (h.nir_fellowship ? 'âœ“ Yes' : 'âœ— No') + '</div></div>' +
    '</div></div>';

  // â”€â”€ Infrastructure Score & Tier â”€â”€
  html += '<div class="drawer-section">' +
    '<div class="drawer-section-title">Clinical Priority</div>' +
    '<div class="infra-gauge-container">' +
    '<div class="infra-gauge" style="background: conic-gradient(' + tierColor + ' ' + (h.infrastructure_score * 3.6) + 'deg, #e2e8f0 0);">' +
    '<div style="width:48px;height:48px;border-radius:50%;background:white;display:flex;align-items:center;justify-content:center;">' +
    '<span class="infra-gauge-value" style="color:' + tierColor + '">' + h.infrastructure_score + '</span>' +
    '</div></div>' +
    '<div class="infra-gauge-info">' +
    '<div class="infra-tier-badge" style="background:' + tierColor + '">Tier ' + h.clinical_tier + ' â€” ' + h.clinical_tier_label + '</div>' +
    '<div class="infra-tier-desc">Infrastructure Score: ' + h.infrastructure_score + '/100</div>' +
    '<div style="font-size:11px;color:#94a3b8;margin-top:2px;">' + cadenceMap[h.clinical_tier] + ' cadence recommended</div>' +
    '</div></div></div>';

  // â”€â”€ Infrastructure Checklist â”€â”€
  html += '<div class="drawer-section">' +
    '<div class="drawer-section-title">Infrastructure Checklist</div>' +
    '<div class="infra-checklist">' +
    '<div class="infra-check-item">' + checkIcon(h.thrombectomy_24_7) + '<span class="infra-check-label">24/7 Thrombectomy</span></div>' +
    '<div class="infra-check-item">' + checkIcon(h.neuro_icu) + '<span class="infra-check-label">Neuro ICU</span></div>' +
    '<div class="infra-check-item">' + checkIcon(h.ct_scanner) + '<span class="infra-check-label">CT Scanner</span></div>' +
    '<div class="infra-check-item">' + checkIcon(h.tpa_available) + '<span class="infra-check-label">tPA Available</span></div>' +
    '<div class="infra-check-item">' + checkIcon(h.telestroke) + '<span class="infra-check-label">Telestroke</span></div>' +
    '<div class="infra-check-item">' + checkIcon(h.cah) + '<span class="infra-check-label">Critical Access</span></div>' +
    '<div class="infra-check-item">' + checkIcon(h.spoke_hospital) + '<span class="infra-check-label">Spoke Hospital</span></div>' +
    '<div class="infra-check-item">' + checkIcon(h.medevac_available) + '<span class="infra-check-label">Medevac</span></div>' +
    '</div></div>';

  // â”€â”€ Catchment Demographics â”€â”€
  if (h.pop_total > 0) {
    html += '<div class="drawer-section">' +
      '<div class="drawer-section-title">Catchment Demographics</div>' +
      '<div class="detail-grid" style="margin-bottom:12px;">' +
      '<div class="detail-item"><div class="detail-label">Total Population</div><div class="detail-value">' + fmt(h.pop_total) + '</div></div>' +
      '<div class="detail-item"><div class="detail-label">Population 65+</div><div class="detail-value">' + fmt(h.pop_65_plus) + ' (' + h.pop_65_pct + '%)</div></div>' +
      '<div class="detail-item"><div class="detail-label">Effective Population</div><div class="detail-value">' + fmt(h.effective_pop) + '</div></div>' +
      '<div class="detail-item"><div class="detail-label">Median Age</div><div class="detail-value">' + (h.median_age || 'â€”') + '</div></div>' +
      '<div class="detail-item"><div class="detail-label">Life Expectancy</div><div class="detail-value">' + (h.life_expectancy || 'â€”') + '</div></div>' +
      '</div></div>';
  }

  // â”€â”€ Stroke Epidemiology â”€â”€
  html += '<div class="drawer-section">' +
    '<div class="drawer-section-title">Stroke Epidemiology (Estimated)</div>';

  if (h.ischemic_volume > 0 || h.strokes_yr > 0) {
    html += '<div class="epi-summary">' +
      '<div class="epi-card"><div class="epi-card-value">' + fmt(h.ischemic_volume) + '</div><div class="epi-card-label">Ischemic/Yr</div></div>' +
      '<div class="epi-card"><div class="epi-card-value">' + fmt(h.lvo_volume) + '</div><div class="epi-card-label">LVO Cases</div></div>' +
      '<div class="epi-card"><div class="epi-card-value">' + fmt(h.mt_eligible) + '</div><div class="epi-card-label">MT Eligible</div></div>' +
      '</div>';

    html += '<div class="prev-bar-container">' +
      '<div class="prev-bar-label"><span class="prev-bar-name">Ischemic (216/100k eff. pop)</span><span class="prev-bar-val">' + fmt(h.ischemic_volume) + '/yr</span></div>' +
      '<div class="prev-bar"><div class="prev-bar-fill" style="width:' + Math.round(h.ischemic_volume / maxIschemic * 100) + '%;background:var(--jnj-red);"></div></div>' +
      '</div>';

    html += '<div class="prev-bar-container">' +
      '<div class="prev-bar-label"><span class="prev-bar-name">LVO (21% of ischemic)</span><span class="prev-bar-val">' + fmt(h.lvo_volume) + '/yr</span></div>' +
      '<div class="prev-bar"><div class="prev-bar-fill" style="width:' + Math.round(h.lvo_volume / maxLvo * 100) + '%;background:var(--jnj-blue);"></div></div>' +
      '</div>';

    html += '<div class="prev-bar-container">' +
      '<div class="prev-bar-label"><span class="prev-bar-name">Hemorrhagic (12/100k)</span><span class="prev-bar-val">' + fmt(h.hemorrhagic_volume) + '/yr</span></div>' +
      '<div class="prev-bar"><div class="prev-bar-fill" style="width:' + Math.round(h.hemorrhagic_volume / maxHemorrhagic * 100) + '%;background:#7C3AED;"></div></div>' +
      '</div>';

    html += '<div class="prev-bar-container">' +
      '<div class="prev-bar-label"><span class="prev-bar-name">AVM/Aneurysm (12/100k)</span><span class="prev-bar-val">' + fmt(h.avm_aneurysm_volume) + '/yr</span></div>' +
      '<div class="prev-bar"><div class="prev-bar-fill" style="width:' + Math.round(h.avm_aneurysm_volume / maxAvm * 100) + '%;background:#059669;"></div></div>' +
      '</div>';

    // Hemorrhagic subtypes
    if (h.hemorrhagic_volume > 0) {
      html += '<div style="margin-top:8px;padding:8px;background:#f8fafc;border-radius:6px;">' +
        '<div style="font-size:10px;color:#94a3b8;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:6px;">Hemorrhagic Subtypes</div>' +
        '<div class="detail-grid">' +
        '<div class="detail-item"><div class="detail-label">SAH (5%)</div><div class="detail-value">' + fmt(h.sah_volume) + '</div></div>' +
        '<div class="detail-item"><div class="detail-label">ICH (80%)</div><div class="detail-value">' + fmt(h.ich_volume) + '</div></div>' +
        '</div></div>';
    }
  } else {
    html += '<div style="padding:12px;background:#f8fafc;border-radius:6px;font-size:12px;color:#94a3b8;text-align:center;">No catchment population data â€” epidemiology estimates unavailable</div>';
  }
  html += '</div>';

  // â”€â”€ A-Fib (conditional) â”€â”€
  if (h.afib_prevalence > 0 || h.afib_count > 0) {
    html += '<div class="drawer-section">' +
      '<div class="drawer-section-title">Atrial Fibrillation</div>' +
      '<div class="detail-grid">' +
      '<div class="detail-item"><div class="detail-label">Prevalence</div><div class="detail-value">' + (h.afib_prevalence ? h.afib_prevalence + '%' : 'â€”') + '</div></div>' +
      '<div class="detail-item"><div class="detail-label">Absolute Count</div><div class="detail-value">' + (h.afib_count ? fmt(h.afib_count) : 'â€”') + '</div></div>' +
      '<div class="detail-item"><div class="detail-label">MMAE Score</div><div class="detail-value">' + (h.mmae_score || 'â€”') + '</div></div>' +
      '<div class="detail-item"><div class="detail-label">Benefit Radius</div><div class="detail-value">' + (h.clinical_benefit_radius ? h.clinical_benefit_radius + ' km' : 'â€”') + '</div></div>' +
      '</div></div>';
  }

  // â”€â”€ Geographic Access & Travel â”€â”€
  html += '<div class="drawer-section">' +
    '<div class="drawer-section-title">Geographic Access & Travel</div>' +
    '<div class="geo-access-badge ' + getGeoAccessClass(h.geographic_access) + '">' +
    getGeoAccessIcon(h.geographic_access) + ' ' + h.geographic_access +
    '</div>' +
    '<div class="detail-grid">' +
    '<div class="detail-item"><div class="detail-label">Closest Team Member</div><div class="detail-value" style="font-size:12px;">' + h.closest_team_member + '</div></div>' +
    '<div class="detail-item"><div class="detail-label">Distance</div><div class="detail-value">' + h.travel_miles + ' mi</div></div>' +
    '<div class="detail-item"><div class="detail-label">Drive Time</div><div class="detail-value">' + h.travel_time_min + ' min</div></div>' +
    '<div class="detail-item"><div class="detail-label">Recommended Cadence</div><div class="detail-value">' + cadenceMap[h.clinical_tier] + '</div></div>' +
    '<div class="detail-item"><div class="detail-label">Road Access</div><div class="detail-value">' + (h.road_access ? 'âœ“ Yes' : 'âœ— Limited') + '</div></div>' +
    '<div class="detail-item"><div class="detail-label">Medevac</div><div class="detail-value">' + (h.medevac_available ? 'âœ“ Available' : 'â€”') + '</div></div>' +
    '</div></div>';

  // â”€â”€ Comment â”€â”€
  if (h.comment) {
    html += '<div style="margin-top:4px;padding:8px;background:#fffbeb;border-radius:6px;font-size:11px;color:#92400e;">ðŸ’¡ ' + h.comment + '</div>';
  }

  document.getElementById('drawerBody').innerHTML = html;
  document.getElementById('accountDrawer').classList.add('open');
  renderCards();
  showToast('Viewing ' + h.short_name);
}

function closeDrawer() {
  document.getElementById('accountDrawer').classList.remove('open');
  selectedHospital = null;
  renderCards();
}

// â”€â”€ Calendar Panel â”€â”€
function openCalendar() {
  closeDrawer();
  const months = [
    { name: 'March 2026', weeks: 4, startWeek: 1 },
    { name: 'April 2026', weeks: 4, startWeek: 5 },
    { name: 'May 2026', weeks: 5, startWeek: 9 },
    { name: 'June 2026', weeks: 4, startWeek: 14 },
    { name: 'July 2026', weeks: 5, startWeek: 18 },
    { name: 'August 2026', weeks: 4, startWeek: 23 }
  ];

  const deptColors = {
    'Physician Lab': 'var(--dept-physician)',
    'Stroke Coord': 'var(--dept-stroke)',
    'Education Coord': 'var(--dept-education)',
    'Buying/VAC': 'var(--dept-buying)'
  };

  // Cadence based on clinical tier: T1=weekly, T2=biweekly, T3=monthly
  const cadenceWeeks = { 1: 1, 2: 2, 3: 4 };

  let calHtml = '<div class="cadence-legend">' +
    '<div class="cadence-legend-item"><div class="cal-dept-dot" style="background:var(--dept-physician)"></div>Physician Lab</div>' +
    '<div class="cadence-legend-item"><div class="cal-dept-dot" style="background:var(--dept-stroke)"></div>Stroke Coord</div>' +
    '<div class="cadence-legend-item"><div class="cal-dept-dot" style="background:var(--dept-education)"></div>Education Coord</div>' +
    '<div class="cadence-legend-item"><div class="cal-dept-dot" style="background:var(--dept-buying)"></div>Buying/VAC</div>' +
    '</div>';

  months.forEach(function(month) {
    calHtml += '<div class="cal-month"><div class="cal-month-title">' + month.name + '</div>';
    for (let w = 0; w < month.weeks; w++) {
      const weekNum = month.startWeek + w;
      calHtml += '<div class="cal-week"><div class="cal-week-label">Wk ' + weekNum + '</div><div class="cal-week-entries">';

      HOSPITALS.forEach(function(h) {
        const cadence = cadenceWeeks[h.clinical_tier];
        if ((weekNum - 1) % cadence === 0) {
          const depts = ['Physician Lab'];
          if (weekNum % 2 === 0) depts.push('Stroke Coord');
          if (weekNum % 3 === 0) depts.push('Education Coord');
          if (weekNum % 4 === 0) depts.push('Buying/VAC');

          const dots = depts.map(function(d) { return '<div class="cal-dept-dot" style="background:' + deptColors[d] + '" title="' + d + '"></div>'; }).join('');
          const label = h.short_name.length > 14 ? h.short_name.substring(0, 12) + 'â€¦' : h.short_name;
          calHtml += '<div class="cal-entry" onclick="openDrawer(' + HOSPITALS.indexOf(h) + ')" style="cursor:pointer;" title="' + h.short_name + ': ' + depts.join(', ') + '">' + dots + '<span>' + label + '</span></div>';
        }
      });

      calHtml += '</div></div>';
    }
    calHtml += '</div>';
  });

  document.getElementById('calendarBody').innerHTML = calHtml;
  document.getElementById('calendarPanel').classList.add('open');
  showToast('Cadence calendar opened');
}

function closeCalendar() {
  document.getElementById('calendarPanel').classList.remove('open');
}

// â”€â”€ Fit All â”€â”€
function fitAll() {
  const bounds = L.latLngBounds(HOSPITALS.map(h => [h.lat, h.lng]));
  map.fitBounds(bounds, { padding: [40, 40] });
  showToast('Map fitted to all markers');
}

// â”€â”€ Event Listeners â”€â”€
document.getElementById('drawerClose').addEventListener('click', closeDrawer);
document.getElementById('calendarClose').addEventListener('click', closeCalendar);
document.getElementById('btnFitAll').addEventListener('click', fitAll);
document.getElementById('btnCalendar').addEventListener('click', function() {
  if (document.getElementById('calendarPanel').classList.contains('open')) {
    closeCalendar();
  } else {
    openCalendar();
  }
});
document.getElementById('btnZoomIn').addEventListener('click', function() { map.zoomIn(); });
document.getElementById('btnZoomOut').addEventListener('click', function() { map.zoomOut(); });

// Search
document.getElementById('searchInput').addEventListener('input', renderCards);

// Filters
document.querySelectorAll('.filter-btn').forEach(function(btn) {
  btn.addEventListener('click', function() {
    document.querySelectorAll('.filter-btn').forEach(function(b) { b.classList.remove('active'); });
    btn.classList.add('active');
    activeFilter = btn.dataset.filter;
    renderCards();
  });
});

// Sort
document.getElementById('sortSelect').addEventListener('change', function(e) {
  activeSortKey = e.target.value;
  renderCards();
});

// â”€â”€ Initialize â”€â”€
createMarkers();
renderCards();

// Close drawer/calendar on Escape
document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') { closeDrawer(); closeCalendar(); }
});
</script>
</body>
</html>